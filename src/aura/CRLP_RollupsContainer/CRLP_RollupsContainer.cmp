<aura:component implements="force:appHostable, flexipage:availableForAllPageTypes" access="GLOBAL" controller="CRLP_RollupUI_SVC">
    <!-- public attributes -->
    <aura:attribute name="rollupList" type="CRLP_RollupsUI_SVC.RollupTableItem[]" access="public"/>
    <aura:attribute name="filterGroupList" type="CRLP_RollupsUI_SVC.Filter_Group__mdt[]" access="public"/>
    <aura:attribute name="columns" type="List" access="public"/>
    <aura:attribute name="activeRollupId" type="Id"/>
    <aura:attribute name="activeRollup" type="Object"/>
    <!--<aura:attribute name="breadcrumbLevel" type="Integer" access="public" default="0"/>-->
    <!-- private attributes -->
    <aura:attribute name="labels" type="Map" access="private"/>
    <aura:attribute name="isRollupsGrid" type="Boolean" access="private"/>
    <aura:attribute name="isFilterGroupsGrid" type="Boolean" access="private"/>
    <aura:attribute name="isRollupDetail" type="Boolean" access="private"/>
    <!--<aura:attribute name="breadcrumbs" type="Object[]" access="private"/>-->

    <!-- events we handle -->
    <aura:handler name="init" value="{!this}" action="{!c.doInit}" />
    <aura:handler name="change" value="{!v.activeRollupId}" action="{!c.handleRollupSelect}" />

    <!-- markup -->

    <!--BEGIN BREADCRUMB-->
    <div class="slds-p-horizontal--large slds-p-top--large">
        <lightning:breadcrumbs>
            <lightning:breadcrumb label="{!v.labels.return}" href="/apex/STG_SettingsManager"/>
            <aura:if isTrue="{!or(v.isFilterGroupsGrid,v.isRollupDetail)}">
                <lightning:breadcrumb label="{!v.labels.rollupSummaryTitle}" onclick="{!c.displayRollupsGrid}" name="{!v.labels.rollupSummaryTitle}" title="{!v.labels.rollupSummaryTitle}"/>
            </aura:if>
            <!--<aura:iteration items="{!v.breadcrumbs}" var="bread">
                <lightning:breadcrumb label="{!bread.label}" onclick="{!c+'.'+bread.onclick}" name="{!bread.label}" title="{!bread.label}"/>
            </aura:iteration>-->
        </lightning:breadcrumbs>
    </div>
    <!--END BREADCRUMB-->

    <!--BEGIN HEADER-->
    <div class="slds-p-around--large">
        <aura:if isTrue="{!v.isRollupsGrid}">
            <h1 class="slds-page-header__title" title="{!v.labels.rollupSummaryTitle}">{!v.labels.rollupSummaryTitle}</h1>
        </aura:if>
        <aura:if isTrue="{!v.isFilterGroupsGrid}">
            <h1 class="slds-page-header__title" title="{!v.labels.filterGroupLabelPlural}">{!v.labels.filterGroupLabelPlural}</h1>
        </aura:if>
        <aura:if isTrue="{!v.isRollupDetail}">
            <p class="slds-text-heading--label">{!v.labels.rollupLabel}</p>
            <h1 class="slds-page-header__title" title="{!v.activeRollup.MasterLabel}">{!v.activeRollup.MasterLabel}</h1>
        </aura:if>
    </div>
    <aura:if isTrue="{! !v.isRollupDetail }">
        <div class="slds-p-horizontal--large slds-p-bottom--large">
        <!--TODO:add onChange function-->
        <lightning:layout horizontalAlign="spread">
            <lightning:layoutItem flexibility="auto">
                <aura:if isTrue="{!v.isRollupsGrid}">
                    <lightning:select name="selectObject" label="Select Rollup Type" variant="label-hidden">
                        <option value="All">Select All</option>
                        <option value="Account">Account</option>
                        <option value="Contact">Contact</option>
                        <option value="GAU">GAU</option>
                    </lightning:select>
                </aura:if>
            </lightning:layoutItem>
            <lightning:layoutItem flexibility="auto">
                <lightning:buttonGroup >
                    <aura:if isTrue="{!v.isRollupsGrid}">
                        <lightning:button label="{!v.labels.rollupNew}"/>
                        <lightning:button label="{!v.labels.view+' '+v.labels.filterGroupLabelPlural}" onclick="{!c.displayFilterGroupsGrid}"/>
                    </aura:if>
                    <aura:if isTrue="{!v.isFilterGroupsGrid}">
                        <lightning:button label="{!v.labels.filterGroupNew}"/>
                        <lightning:button label="{!v.labels.view+' '+v.labels.rollupSummaryTitle}" onclick="{!c.displayRollupsGrid}"/>
                    </aura:if>
                </lightning:buttonGroup>
            </lightning:layoutItem>
        </lightning:layout>
    </div>
    </aura:if>
    <!--END HEADER-->

    <!--BEGIN ROLLUPS GRID-->
    <aura:if isTrue="{!v.isRollupsGrid}">
        <div class="slds-p-horizontal--large slds-p-bottom--large">
            <aura:if isTrue="true"> <!--//TODO: add better no-data-found error handling-->
                <table class="slds-table slds-table_bordered">
                    <c:tableHeader hasAction="true" columns="{!v.columns}" labels="{!v.labels}"/>
                    <tbody>
                    <aura:iteration var="rollup" items="{!v.rollupList}">
                        <c:CRLP_RollupRow rollup="{!rollup}" labels="{!v.labels}" activeRollupId="{!v.activeRollupId}"/>
                    </aura:iteration>
                    </tbody>
                </table>
                <aura:set attribute="else">
                    <ui:message severity="info" closable="false">
                        No Rollups found. //NEEDS CUSTOM LABEL
                    </ui:message>
                </aura:set>
            </aura:if>
        </div>

    </aura:if>
    <!--END ROLLUPS GRID-->

    <!--BEGIN FILTER GROUPS GRID -->
    <aura:if isTrue="{!v.isFilterGroupsGrid}">
        <div class="slds-p-horizontal--large slds-p-bottom--large">
            <aura:if isTrue="true"> <!--//TODO: add better no-data-found error handling-->
                <table class="slds-table slds-table_bordered">
                    <c:tableHeader hasAction="true" columns="{!v.columns}" labels="{!v.labels}"/>
                    <tbody>
                    <aura:iteration var="filterGroup" items="{!v.filterGroupList}">
                        <c:CRLP_FilterGroupRow filterGroup="{!filterGroup}" labels="{!v.labels}"/>
                    </aura:iteration>
                    </tbody>
                </table>
                <aura:set attribute="else">
                    <ui:message severity="info" closable="false">
                        No Filter Groups found. //NEEDS CUSTOM LABEL
                    </ui:message>
                </aura:set>
            </aura:if>
        </div>
    </aura:if>
    <!--END FILTER GROUPS GRID-->

    <!--BEGIN ROLLUP DETAIL-->
    <aura:if isTrue="{!v.isRollupDetail}">
        <div class="slds-p-bottom--large">
            <c:CRLP_Rollup labels="{#v.labels}" activeRollup="{!v.activeRollup}" mode="view" />
        </div>
    </aura:if>
    <!--END ROLLUP DETAIL-->

</aura:component>