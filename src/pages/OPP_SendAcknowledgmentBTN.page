<apex:page standardController="Opportunity" 
    extensions="OPP_SendAcknowledgmentBTN_CTRL"
    recordSetVar="listOpp"
    action="{!SendAcknowledgment}"
    standardStylesheets="false"
    title="{!$Label.sendAcknowledgmentPageTitle}"
    docType="html-5.0">

    <apex:slds />
    
    <apex:form id="vfForm">
        <div class="slds">
            <!-- PAGE HEADER -->
            <c:UTIL_PageHeader showBreadcrumb="true" parentEntityLabel="Opportunity"
                               parentAction="{! URLFOR($Action.Opportunity.View, recordId)}"
                               parentRecordAction="/{!recordId}"
                               header="{!$Label.sendAcknowledgmentPageTitle}"
                               icon="opportunity_120" iconCategory="standard"
                               showSaveBtn="false" cancelLabel="{!$Label.sendAcknowledgmentReturnLinkLabel}"
                               cancelAction="{!close}" cancelImmediate="true" />

            <!-- PAGE MESSAGE -->
            <c:UTIL_PageMessages />
            <!-- PAGE RETURN -->
            <c:UTIL_NavigateBack recordId="{!recordId}" redirect="{!redirect}"/>
            <!-- FAILED EMAILS -->
            <apex:outputPanel rendered="{!cNotSent > 0}">
                <div class="slds-grid">
                    <div class="slds-col slds-size_1-of-1 slds-m-around_medium">
                        <p class="slds-m-top_x-small slds-p-bottom_small"><apex:outputText value="{!$Label.sendAcknowledgmentFailureReasons}" escape="false"/></p>
                        <ul class="slds-list_dotted">
                            <apex:repeat value="{!listOppNotSent}" var="opp">
                                <li class="slds-item">
                                    <apex:outputLink onClick="navigateToSObjectNewWindow('{!opp.Id}');">{!opp.Name}</apex:outputLink>
                                </li>
                            </apex:repeat>
                        </ul>
                    </div>
                </div>
            </apex:outputPanel>
        </div>
    </apex:form>
    <script>
        function navigateToSObjectNewWindow(recordId) {
            if (typeof sforce !== "undefined" && sforce !== null) {
                // Salesforce1 navigation
                sforce.one.navigateToSObject(recordId);
            } else {
                // Desktop navigation
                window.open('/' + recordId, '_blank');
            }
        }
    </script>
</apex:page>